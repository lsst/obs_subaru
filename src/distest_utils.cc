#include<stdio.h>
#include<stdlib.h>
#include<math.h>
#include "hsc/meas/match/distest_utils.h"

#define DEBUG 0
 
//#define ANUM 34
//#define fieldMAX (0.8*60*60/0.202)

double ELdpAx2nd30[] = {
-6.651920e-21 , -6.435769e-09 ,
-5.801012e-09 , -1.500538e-21 ,
-1.720367e-21 , -1.159457e-08 ,
-1.053970e-10 , -1.485385e-23 ,
+3.630631e-24 , -1.052341e-10 ,
-1.054756e-10 , +3.201359e-23 ,
+5.084026e-24 , -1.055773e-10 ,
+4.592606e-29 , -6.612624e-19 ,
+4.278309e-29 , -3.679379e-18 ,
+1.109091e-29 , -3.818888e-18 ,
-2.436287e-21 , +3.627465e-31 ,
-7.118360e-32 , -7.011440e-21 ,
-5.427354e-21 , -3.762346e-31 ,
-2.312258e-31 , -9.258348e-21 ,
-1.549767e-21 , -7.862500e-31 ,
-1.250499e-31 , +1.061226e-22 ,
-1.828781e-28 , -2.733921e-39 ,
+4.513050e-40 , -1.426167e-28 ,
-5.267172e-28 , -2.520661e-40 ,
+2.233522e-39 , -4.640470e-28 ,
-5.647409e-28 , +8.729648e-39 ,
+2.835691e-39 , -5.152936e-28 ,
-1.881953e-28 , +5.937560e-39 ,
+9.460474e-40 , -1.981382e-28 ,
+3.468674e-37 , +6.500976e-48 ,
-9.284974e-49 , +2.413717e-37 ,
+1.274893e-36 , +7.805989e-48 ,
-6.107773e-48 , +1.050743e-36 ,
+2.078567e-36 , -1.934324e-47 ,
-1.220454e-47 , +1.748460e-36 ,
+1.457317e-36 , -3.508758e-47 ,
-9.319759e-48 , +1.299431e-36 ,
+3.478747e-37 , -1.411105e-47 ,
-2.253396e-48 , +3.715671e-37
};

double ELdpAx2nd40[] = {
-1.041036e-21 , -4.230889e-09 ,
-3.806403e-09 , +2.754181e-22 ,
-2.452757e-22 , -7.634552e-09 ,
-1.053811e-10 , -9.026158e-24 ,
-1.866315e-23 , -1.053300e-10 ,
-1.054836e-10 , +3.733699e-23 ,
+4.840509e-24 , -1.054947e-10 ,
+3.961335e-30 , -4.860693e-19 ,
+2.039013e-29 , -2.255860e-18 ,
-2.472098e-31 , -2.533312e-18 ,
-3.077951e-21 , +1.872701e-31 ,
+3.170923e-31 , -5.546622e-21 ,
-5.347730e-21 , -3.588110e-31 ,
+6.382591e-31 , -6.267878e-21 ,
-1.273758e-21 , -1.053517e-30 ,
-1.487411e-31 , -2.236429e-21 ,
-1.761649e-28 , -1.235839e-39 ,
-1.551574e-39 , -1.518619e-28 ,
-5.287763e-28 , -3.233580e-40 ,
-8.645434e-39 , -4.937379e-28 ,
-5.613287e-28 , +9.667366e-39 ,
-4.807162e-39 , -5.417831e-28 ,
-1.917196e-28 , +8.689816e-39 ,
+1.272437e-39 , -1.784248e-28 ,
+3.276759e-37 , +2.623093e-48 ,
+2.050143e-48 , +2.616714e-37 ,
+1.284510e-36 , +6.372145e-48 ,
+2.603851e-47 , +1.142480e-36 ,
+2.053719e-36 , -1.790416e-47 ,
+3.675519e-47 , +1.872377e-36 ,
+1.447314e-36 , -4.304037e-47 ,
+9.753601e-48 , +1.369906e-36 ,
+3.601339e-37 , -2.199358e-47 ,
-3.281617e-48 , +3.196440e-37 
};

double ELdpAx2nd50[] = {
-1.993475e-21 , -2.877175e-09 ,
-2.600805e-09 , -1.242853e-21 ,
+1.035420e-22 , -5.161200e-09 ,
-1.053641e-10 , -3.478306e-24 ,
+2.405230e-23 , -1.053206e-10 ,
-1.055298e-10 , +2.012787e-23 ,
-5.646744e-24 , -1.055701e-10 ,
+1.547204e-29 , -2.788715e-19 ,
-1.637791e-30 , -1.866547e-18 ,
+7.535191e-31 , -1.761229e-18 ,
-4.322449e-21 , +1.052336e-31 ,
-6.306777e-31 , -5.166716e-21 ,
-2.908461e-21 , -5.672857e-31 ,
-3.903212e-31 , -7.074059e-21 ,
-8.635761e-22 , -4.278055e-31 ,
+1.333623e-31 , -3.646376e-22 ,
-1.619548e-28 , -8.850763e-40 ,
+5.022900e-39 , -1.558837e-28 ,
-5.480808e-28 , +3.796425e-39 ,
+7.461374e-39 , -4.968049e-28 ,
-5.876282e-28 , +8.792683e-39 ,
+1.800872e-39 , -5.328160e-28 ,
-1.912750e-28 , +2.740862e-39 ,
-9.932578e-40 , -1.933218e-28 ,
+2.846489e-37 , +2.245755e-48 ,
-1.245608e-47 , +2.723604e-37 ,
+1.327319e-36 , -6.719497e-48 ,
-2.965245e-47 , +1.160360e-36 ,
+2.160352e-36 , -3.343695e-47 ,
-2.123924e-47 , +1.891530e-36 ,
+1.522937e-36 , -2.950993e-47 ,
-1.930864e-48 , +1.338325e-36 ,
+3.518844e-37 , -5.480816e-48 ,
+2.357510e-48 , +3.582287e-37
};

double ELdpAx2nd60[] = {
+4.657233e-21 , -1.998033e-09 ,
-1.794899e-09 , +5.055449e-22 ,
-9.630671e-21 , -3.585307e-09 ,
-1.053228e-10 , +6.289278e-24 ,
-1.793293e-23 , -1.053224e-10 ,
-1.055760e-10 , -8.876309e-24 ,
+5.029740e-24 , -1.055461e-10 ,
-2.567613e-29 , -1.672025e-19 ,
+2.486584e-29 , -1.178868e-18 ,
+6.042213e-29 , -1.181895e-18 ,
-4.695203e-21 , -1.152052e-31 ,
+4.764781e-31 , -5.298166e-21 ,
-2.472379e-21 , -3.233959e-31 ,
+2.451755e-31 , -8.068253e-21 ,
+2.522777e-22 , +4.097871e-31 ,
-1.180084e-31 , -9.697926e-22 ,
-1.626792e-28 , +6.491086e-40 ,
-3.868417e-39 , -1.549596e-28 ,
-5.456799e-28 , +5.510183e-39 ,
-4.924937e-39 , -4.812801e-28 ,
-5.997547e-28 , -2.539732e-40 ,
-8.402805e-40 , -5.193993e-28 ,
-1.998239e-28 , -3.979596e-39 ,
+8.780190e-40 , -1.887581e-28 ,
+2.924998e-37 , -1.132381e-48 ,
+9.781726e-48 , +2.711095e-37 ,
+1.303754e-36 , -1.856936e-47 ,
+2.009141e-47 , +1.107354e-36 ,
+2.207544e-36 , -1.689575e-47 ,
+1.240839e-47 , +1.807351e-36 ,
+1.564180e-36 , +1.170333e-47 ,
+2.239738e-50 , +1.292905e-36 ,
+3.733524e-37 , +1.084515e-47 ,
-2.086714e-48 , +3.471974e-37
};

double ELdpAx2nd70[] = {
-1.125754e-21 , -1.306428e-09 ,
-1.175850e-09 , +3.647768e-22 ,
-2.492094e-21 , -2.360680e-09 ,
-1.053427e-10 , -5.607966e-24 ,
-3.032573e-23 , -1.053261e-10 ,
-1.055572e-10 , +2.239909e-23 ,
+8.144422e-24 , -1.055573e-10 ,
+8.453021e-30 , -1.618262e-19 ,
+2.246378e-29 , -7.051309e-19 ,
+1.529245e-29 , -7.884900e-19 ,
-4.110094e-21 , +1.489471e-31 ,
+7.274875e-31 , -5.268609e-21 ,
-2.307092e-21 , -5.056300e-31 ,
+5.958292e-31 , -7.643547e-21 ,
-1.779541e-22 , -5.326494e-31 ,
-2.088269e-31 , -8.443692e-22 ,
-1.677985e-28 , -1.175284e-39 ,
-5.397972e-39 , -1.551751e-28 ,
-5.525672e-28 , +2.828552e-39 ,
-1.036218e-38 , -4.836694e-28 ,
-6.000372e-28 , +8.778832e-39 ,
-3.091991e-39 , -5.219453e-28 ,
-1.964425e-28 , +3.863880e-39 ,
+1.631336e-39 , -1.879853e-28 ,
+3.062407e-37 , +2.875308e-48 ,
+1.265681e-47 , +2.714788e-37 ,
+1.335308e-36 , -3.775281e-48 ,
+3.814890e-47 , +1.115837e-36 ,
+2.229521e-36 , -2.956525e-47 ,
+3.315964e-47 , +1.801794e-36 ,
+1.563084e-36 , -3.222991e-47 ,
+3.602049e-48 , +1.296803e-36 ,
+3.645460e-37 , -8.793653e-48 ,
-3.986896e-48 , +3.408684e-37
};

double ELdpAx2nd80[] = {
-6.861747e-21 , -6.688805e-10 ,
-6.044074e-10 , +5.476125e-22 ,
+2.068486e-21 , -1.191876e-09 ,
-1.053584e-10 , -7.116848e-24 ,
-1.740282e-23 , -1.053462e-10 ,
-1.055175e-10 , +1.229122e-23 ,
+8.049582e-24 , -1.055215e-10 ,
+4.106333e-29 , -1.097591e-19 ,
+4.125977e-29 , -7.060494e-19 ,
-1.443311e-29 , -5.668997e-19 ,
-3.770986e-21 , +1.757495e-31 ,
+4.542475e-31 , -5.479116e-21 ,
-3.753770e-21 , -1.055364e-31 ,
+1.878687e-31 , -6.008417e-21 ,
-1.034223e-21 , -3.152718e-31 ,
-1.974316e-31 , -1.429724e-21 ,
-1.699095e-28 , -1.340485e-39 ,
-3.596639e-39 , -1.507431e-28 ,
-5.408910e-28 , -6.669515e-40 ,
-4.735621e-39 , -4.951698e-28 ,
-5.805982e-28 , +3.199908e-39 ,
+2.426737e-40 , -5.448293e-28 ,
-1.899393e-28 , +2.454049e-39 ,
+1.501288e-39 , -1.854121e-28 ,
+3.101752e-37 , +3.223600e-48 ,
+8.875609e-48 , +2.560613e-37 ,
+1.305798e-36 , +5.025847e-48 ,
+1.987555e-47 , +1.133165e-36 ,
+2.152592e-36 , -5.783062e-48 ,
+1.019047e-47 , +1.897289e-36 ,
+1.493747e-36 , -1.373795e-47 ,
-4.397508e-48 , +1.375834e-36 ,
+3.488827e-37 , -5.962446e-48 ,
-3.604642e-48 , +3.383417e-37
};

double ELdpAx2nd90[] = {
+3.533412e-21 , -1.657171e-22 ,
+2.249461e-24 , -2.732296e-23 ,
-1.791908e-21 , +3.109959e-22 ,
-1.053511e-10 , +1.220689e-24 ,
-7.847100e-24 , -1.053184e-10 ,
-1.055315e-10 , +1.233271e-24 ,
-3.676415e-25 , -1.055368e-10 ,
-2.363377e-29 , +1.113565e-30 ,
-2.940972e-30 , -1.522042e-30 ,
+9.941931e-30 , -1.839660e-30 ,
-3.823380e-21 , -3.241670e-32 ,
+1.951054e-31 , -6.172129e-21 ,
-3.905525e-21 , -4.143448e-32 ,
+1.965431e-31 , -5.861077e-21 ,
-3.174122e-22 , -5.618151e-32 ,
+9.257531e-33 , -1.292449e-21 ,
-1.699785e-28 , +2.591862e-40 ,
-1.483592e-39 , -1.453501e-28 ,
-5.422875e-28 , +4.801503e-40 ,
-2.972485e-39 , -4.929941e-28 ,
-5.824732e-28 , +7.641860e-40 ,
-1.538586e-39 , -5.483681e-28 ,
-1.977744e-28 , +5.735733e-40 ,
-7.044399e-41 , -1.855499e-28 ,
+3.105075e-37 , -6.435957e-49 ,
+3.540830e-48 , +2.439179e-37 ,
+1.323566e-36 , -1.671501e-48 ,
+1.066662e-47 , +1.107742e-36 ,
+2.162390e-36 , -2.811116e-48 ,
+1.078751e-47 , +1.911540e-36 ,
+1.510490e-36 , -3.536799e-48 ,
+3.806627e-48 , +1.386850e-36 ,
+3.726541e-37 , -1.640285e-48 ,
+1.676094e-49 , +3.371672e-37
};

double ELpdAx2nd30[] = {
+1.452535e-21 , +6.403937e-09 ,
+6.574114e-09 , +3.390495e-22 ,
+1.596656e-21 , +1.141192e-08 ,
+1.054822e-10 , -1.982725e-23 ,
-1.994885e-23 , +1.052950e-10 ,
+1.055586e-10 , +2.878164e-23 ,
+3.548716e-24 , +1.056578e-10 ,
-9.405454e-30 , +3.204492e-18 ,
-2.465705e-29 , +1.510280e-17 ,
-1.017249e-29 , +1.275402e-17 ,
+3.259801e-20 , +5.211924e-31 ,
+3.940380e-31 , +3.806112e-20 ,
+6.597414e-20 , -2.884337e-31 ,
+6.740729e-31 , +7.071041e-20 ,
+3.177074e-20 , -7.590465e-31 ,
-1.163532e-31 , +3.023646e-20 ,
+2.381810e-28 , -4.195863e-39 ,
-2.403944e-39 , +1.885551e-28 ,
+6.873306e-28 , -1.939502e-39 ,
-9.520621e-39 , +6.087069e-28 ,
+7.317659e-28 , +9.573398e-39 ,
-5.521001e-39 , +6.685874e-28 ,
+2.428495e-28 , +5.932355e-39 ,
+1.056763e-39 , +2.517955e-28 ,
-3.362844e-37 , +1.060653e-47 ,
+4.580406e-48 , -2.016199e-37 ,
-1.201639e-36 , +1.599479e-47 ,
+3.076246e-47 , -9.110639e-37 ,
-2.005058e-36 , -2.175456e-47 ,
+4.172616e-47 , -1.577884e-36 ,
-1.421818e-36 , -4.186798e-47 ,
+1.274787e-47 , -1.210944e-36 ,
-3.317691e-37 , -1.438413e-47 ,
-2.884218e-48 , -3.539833e-37
};

double ELpdAx2nd40[] = {
+6.515836e-21 , +4.210185e-09 ,
+4.314187e-09 , +9.798237e-23 ,
-7.368293e-21 , +7.514210e-09 ,
+1.054621e-10 , -3.098100e-25 ,
-2.284666e-23 , +1.054046e-10 ,
+1.055687e-10 , -3.645033e-23 ,
+2.824670e-24 , +1.055668e-10 ,
-4.081750e-29 , +2.161404e-18 ,
+3.269820e-30 , +9.746856e-18 ,
+4.881223e-29 , +8.420866e-18 ,
+3.340298e-20 , -3.843915e-32 ,
+6.000828e-31 , +3.628560e-20 ,
+6.589510e-20 , +1.373390e-30 ,
+5.138123e-31 , +6.716477e-20 ,
+3.143021e-20 , +7.785683e-31 ,
-7.032178e-32 , +3.291000e-20 ,
+2.296409e-28 , +5.706246e-40 ,
-4.857822e-39 , +2.003295e-28 ,
+6.893754e-28 , -1.278711e-38 ,
-8.737304e-39 , +6.459025e-28 ,
+7.274481e-28 , -1.848553e-38 ,
-3.681827e-39 , +7.012339e-28 ,
+2.472936e-28 , -5.345571e-39 ,
+5.552994e-40 , +2.283617e-28 ,
-3.112081e-37 , -1.932332e-48 ,
+1.235966e-47 , -2.287994e-37 ,
-1.212062e-36 , +3.421113e-47 ,
+3.375186e-47 , -1.031256e-36 ,
-1.971874e-36 , +8.482924e-47 ,
+3.121411e-47 , -1.738924e-36 ,
-1.408120e-36 , +6.062565e-47 ,
+8.306371e-48 , -1.301482e-36 ,
-3.478469e-37 , +1.188490e-47 ,
-1.397569e-48 , -2.895784e-37 
}; 

double ELpdAx2nd50[] = {
-4.089479e-22 , +2.862900e-09 ,
+2.946926e-09 , +2.874113e-22 ,
-8.315454e-22 , +5.078535e-09 ,
+1.054362e-10 , -2.007551e-23 ,
-7.046307e-24 , +1.053895e-10 ,
+1.056269e-10 , +4.834114e-23 ,
-4.510971e-24 , +1.056484e-10 ,
+1.849391e-30 , +1.414343e-18 ,
+1.211811e-29 , +7.000124e-18 ,
+4.981018e-30 , +5.756214e-18 ,
+3.502357e-20 , +5.254898e-31 ,
+2.109850e-31 , +3.596802e-20 ,
+6.296518e-20 , -7.391764e-31 ,
+2.621810e-31 , +6.819452e-20 ,
+3.081361e-20 , -1.265041e-30 ,
+1.236819e-31 , +3.079674e-20 ,
+2.110776e-28 , -4.226301e-39 ,
-1.944887e-39 , +2.041192e-28 ,
+7.128591e-28 , +1.655152e-39 ,
-3.224146e-39 , +6.481889e-28 ,
+7.612911e-28 , +1.624180e-38 ,
-3.192948e-39 , +6.895655e-28 ,
+2.477172e-28 , +1.013857e-38 ,
-1.014730e-39 , +2.459391e-28 ,
-2.535577e-37 , +1.068707e-47 ,
+5.519226e-48 , -2.393208e-37 ,
-1.264712e-36 , +6.571787e-48 ,
+1.178833e-47 , -1.048738e-36 ,
-2.112803e-36 , -4.519461e-47 ,
+1.517942e-47 , -1.757273e-36 ,
-1.511051e-36 , -6.702689e-47 ,
+1.113538e-47 , -1.259463e-36 ,
-3.395771e-37 , -2.549249e-47 ,
+2.588781e-48 , -3.372494e-37
};

double ELpdAx2nd60[] = {
-6.524628e-21 , +1.988655e-09 ,
+2.034233e-09 , -2.564873e-23 ,
+2.812293e-21 , +3.528786e-09 ,
+1.053981e-10 , -3.032504e-24 ,
-2.219390e-23 , +1.053896e-10 ,
+1.056712e-10 , +1.186861e-23 ,
+1.290831e-23 , +1.056231e-10 ,
+4.317746e-29 , +9.501869e-19 ,
+2.321949e-29 , +4.715147e-18 ,
-1.756683e-29 , +3.945518e-18 ,
+3.524715e-20 , +1.070451e-31 ,
+7.003727e-31 , +3.613832e-20 ,
+6.264929e-20 , -5.203142e-31 ,
-2.166042e-32 , +6.938616e-20 ,
+2.965259e-20 , -1.609214e-31 ,
-3.116532e-31 , +3.145321e-20 ,
+2.136076e-28 , -9.797106e-40 ,
-6.286796e-39 , +2.030063e-28 ,
+7.089235e-28 , +4.029043e-39 ,
-4.586638e-39 , +6.289925e-28 ,
+7.730550e-28 , +7.441921e-39 ,
+3.914805e-39 , +6.733242e-28 ,
+2.572136e-28 , +2.488796e-40 ,
+2.367476e-39 , +2.408161e-28 ,
-2.675380e-37 , +2.650490e-48 ,
+1.708031e-47 , -2.379833e-37 ,
-1.234097e-36 , -7.849125e-48 ,
+2.696968e-47 , -9.805781e-37 ,
-2.160886e-36 , -3.450437e-47 ,
-2.220272e-48 , -1.651296e-36 ,
-1.553748e-36 , -2.245796e-47 ,
-1.774280e-47 , -1.202723e-36 ,
-3.648919e-37 , +1.595339e-48 ,
-5.736301e-48 , -3.243728e-37
};

double ELpdAx2nd70[] = {
+4.307440e-21 , +1.299994e-09 ,
+1.332796e-09 , -1.765814e-22 ,
+1.256518e-21 , +2.323437e-09 ,
+1.054220e-10 , +1.341834e-23 ,
-1.419782e-23 , +1.053936e-10 ,
+1.056508e-10 , -5.894598e-23 ,
-4.885675e-25 , +1.056325e-10 ,
-2.974383e-29 , +6.805312e-19 ,
-2.578181e-29 , +3.021777e-18 ,
-9.887702e-30 , +2.609751e-18 ,
+3.452413e-20 , -3.491292e-31 ,
+4.318225e-31 , +3.609251e-20 ,
+6.239046e-20 , +1.183141e-30 ,
+2.648019e-31 , +6.898847e-20 ,
+3.014966e-20 , +1.514731e-30 ,
+2.317418e-32 , +3.140787e-20 ,
+2.201569e-28 , +2.795344e-39 ,
-3.843394e-39 , +2.034120e-28 ,
+7.181453e-28 , -6.619009e-39 ,
-5.040338e-39 , +6.312126e-28 ,
+7.739200e-28 , -2.160795e-38 ,
-1.860886e-39 , +6.748356e-28 ,
+2.530512e-28 , -1.197752e-38 ,
-2.362229e-40 , +2.389710e-28 ,
-2.857874e-37 , -7.040703e-48 ,
+1.044796e-47 , -2.389275e-37 ,
-1.277028e-36 , +9.426886e-48 ,
+2.176472e-47 , -9.898792e-37 ,
-2.191817e-36 , +7.123241e-47 ,
+1.555282e-47 , -1.638951e-36 ,
-1.553457e-36 , +8.428831e-47 ,
+4.702059e-48 , -1.201468e-36 ,
-3.533862e-37 , +2.982095e-47 ,
+6.802402e-49 , -3.138858e-37
};

double ELpdAx2nd80[] = {
-2.623646e-21 , +6.649687e-10 ,
+6.854983e-10 , -2.522811e-22 ,
-3.173802e-25 , +1.170423e-09 ,
+1.054367e-10 , -2.850393e-24 ,
-5.978487e-25 , +1.054157e-10 ,
+1.056065e-10 , +6.634890e-24 ,
+8.725856e-25 , +1.055998e-10 ,
+1.397608e-29 , +3.827245e-19 ,
+2.781179e-29 , +1.941354e-18 ,
-1.284814e-30 , +1.528024e-18 ,
+3.421051e-20 , +9.383089e-32 ,
+5.514842e-32 , +3.632837e-20 ,
+6.408969e-20 , -2.729915e-31 ,
-1.058258e-31 , +6.699667e-20 ,
+3.113253e-20 , -9.728689e-32 ,
-1.114509e-32 , +3.188638e-20 ,
+2.220285e-28 , -8.644166e-40 ,
-7.171105e-40 , +1.981429e-28 ,
+7.033525e-28 , +2.355521e-39 ,
+1.080412e-39 , +6.461621e-28 ,
+7.506593e-28 , +3.372575e-39 ,
+1.175364e-39 , +7.039891e-28 ,
+2.453563e-28 , +4.014773e-40 ,
+3.831877e-41 , +2.375471e-28 ,
-2.889575e-37 , +2.394862e-48 ,
+2.396987e-48 , -2.196573e-37 ,
-1.236341e-36 , -5.375686e-48 ,
-2.088175e-48 , -1.015611e-36 ,
-2.094887e-36 , -1.667469e-47 ,
-7.465016e-48 , -1.764684e-36 ,
-1.467435e-36 , -9.458591e-48 ,
-3.100302e-48 , -1.306955e-36 ,
-3.342481e-37 , -3.651139e-49 ,
-1.981379e-50 , -3.151150e-37
};

double ELpdAx2nd90[] = {
+1.000239e-21 , -1.300330e-22 ,
+1.534622e-23 , +1.027962e-22 ,
-4.853582e-22 , +6.652263e-24 ,
+1.054303e-10 , +1.611447e-24 ,
-1.136925e-23 , +1.053870e-10 ,
+1.056232e-10 , -4.853234e-24 ,
+6.496342e-25 , +1.056150e-10 ,
-6.297084e-30 , +8.476301e-31 ,
-3.718485e-30 , +6.921816e-31 ,
+3.500098e-30 , -5.112718e-32 ,
+3.422947e-20 , -5.234302e-32 ,
+3.107506e-31 , +3.709083e-20 ,
+6.413955e-20 , +1.965177e-31 ,
+2.637943e-31 , +6.678835e-20 ,
+3.030050e-20 , +6.458740e-32 ,
-1.489429e-32 , +3.176975e-20 ,
+2.223931e-28 , +4.707488e-40 ,
-2.598010e-39 , +1.919091e-28 ,
+7.070933e-28 , -1.592512e-39 ,
-4.404008e-39 , +6.439795e-28 ,
+7.534146e-28 , -2.554481e-39 ,
-2.062164e-39 , +7.085610e-28 ,
+2.547976e-28 , -1.415689e-40 ,
+1.161230e-40 , +2.373841e-28 ,
-2.899322e-37 , -1.273328e-48 ,
+6.783687e-48 , -2.050125e-37 ,
-1.266541e-36 , +3.374676e-48 ,
+1.720237e-47 , -9.849755e-37 ,
-2.113097e-36 , +1.221468e-47 ,
+1.603125e-47 , -1.784465e-36 ,
-1.488238e-36 , +7.134291e-48 ,
+5.200945e-48 , -1.321602e-36 ,
-3.642011e-37 , -3.810435e-49 ,
-2.973972e-49 , -3.127947e-37
};


/*-----------------------------------------------------*/
int DISTEstdp(float  x_real, float y_real, float *x_in, float *y_in, float el, double (*Apdx)[ANUM][2], double (*Adpx)[ANUM][2])
/*-----------------------------------------------------*/
/*
  input:
     x_real, y_real: distorted position of object, where  
           y_real axis (positive direction) is to the zenith.
     el: elevation of telescope pointing
    
  output:
     *x_in, *y_in: intrinsinc position before optics, where  
           y_in axis (positive direction) is to the zenith.

  original coded by Yuki Okura, April 2010 
  based on ZEMAX data provided by Yutaka Komiyama 

 */
{

  //  float dp[2],pp[2];
  double dp[2],pp[2];
  int ret;

  dp[0]=x_real;
  dp[1]=y_real;

  //printf("--- estimating predicted point from given distorted point ---\n");
  //		printf("Elevation : %f\n",EL);
  //		printf("given distorted point : %f,%f\n",dp[0],dp[1]);
  //if(sqrt(dp[0]*dp[0]+dp[1]*dp[1])>fieldMAX)
  //printf("Warning! : outer point of fitted region !\n");
  //	}else{
  //		printf("Usage with : (float)[Elevatoin] (float)[distorted point x] (float)[distorted point y] \n");
  //		return 0;
  //	}                                  
  //  printf("1:real :%f,%f,%f\n",dp[0],dp[1],el);
  ret=fpdEst(1,el,dp,pp, Apdx, Adpx);

  //  printf("2:real :%f,%f -> ref :%f,%f\n",dp[0],dp[1],pp[0],pp[1]);    

  if(ret != 0) {
    printf("DISTEstdp can not provide distortion. exit.\n");
    return -1;
  }

  *x_in = (float) pp[0]; 
  *y_in = (float) pp[1];

  //  printf("dist :%f,%f	->	est. predict :%f,%f\n",dp[0],dp[1],pp[0],pp[1]);

  return 0;
}

/*-----------------------------------------------------*/
int DISTEstpd(float  x_in, float y_in, float *x_real, float *y_real, float el, double (*Apdx)[ANUM][2], double (*Adpx)[ANUM][2])
/*-----------------------------------------------------*/
/*
  input:
     x_in, y_in: intrinsinc position before optics, where 
           y_in axis (positive direction) is to the zenith.
     el: elevation of telescope pointing
    
  output:
     *x_real, *y_real: distorted position of object, where  
           y_real axis (positive direction) is to the zenith.

  original coded by Yuki Okura, April 2010 
  based on ZEMAX data provided by Yutaka Komiyama 
 */
{

  //  float dp[2],pp[2];
  double dp[2], pp[2];
  int ret;

  pp[0]=x_in;
  pp[1]=y_in;

  //  printf("1:ref :%f,%f,%f\n",pp[0],pp[1],el);
  ret=fpdEst(0,el,pp,dp, Apdx, Adpx);
  //  printf("2:ref :%f,%f -> real :%f,%f\n",pp[0],pp[1],dp[0],dp[1]);
  if(ret != 0) {
    printf("DISTEstpd can not provide distortion. exit.\n");
    return -1;
  }

  *x_real=(float) dp[0];
  *y_real=(float) dp[1];

  return 0;

}

//#define float float
//#define ANUM 34
//#define INFMIN pow(10,-6)
/*-----------------------------------------------------*/
//void fBx(float inx[], float Bx[])
void fBx(double inx[], double Bx[])
/*-----------------------------------------------------*/
{

  //  float x,y,r;
  double x,y;
  x=inx[0];
  y=inx[1];
//  r=sqrt(x*x+y*y);
  
  Bx[0]=x*x;//y dist ”ñ‘ÎÌ
  Bx[1]=x*y;//x dist ”ñ‘ÎÌ
  Bx[2]=y*y;//y dist ”ñ‘ÎÌ     
  Bx[3]=x*x*x;//x dist
  Bx[4]=x*x*y;//y dist     
  Bx[5]=x*y*y;//x dist
  Bx[6]=y*y*y;//y dist 
  Bx[7]=x*x*x*x;//y dist HsBP>N
  Bx[8]=x*x*y*y;//y dist HsBP>N 
  Bx[9]=y*y*y*y;//y dist HsBP>N  
  Bx[10]=x*x*x*x*x;//x dist
  Bx[11]=x*x*x*x*y;//y dist
  Bx[12]=x*x*x*y*y;//x dist
  Bx[13]=x*x*y*y*y;//y dist
  Bx[14]=x*y*y*y*y;//x dist
  Bx[15]=y*y*y*y*y;//y dist
  Bx[16]=x*x*x*x*x*x*x;//x dist
  Bx[17]=x*x*x*x*x*x*y;//y dist
  Bx[18]=x*x*x*x*x*y*y;//x dist
  Bx[19]=x*x*x*x*y*y*y;//y dist
  Bx[20]=x*x*x*y*y*y*y;//x dist
  Bx[21]=x*x*y*y*y*y*y;//y dist
  Bx[22]=x*y*y*y*y*y*y;//x dist
  Bx[23]=y*y*y*y*y*y*y;//y dist  
  Bx[24]=x*x*x*x*x*x*x*x*x;
  Bx[25]=x*x*x*x*x*x*x*x*y;
  Bx[26]=x*x*x*x*x*x*x*y*y;
  Bx[27]=x*x*x*x*x*x*y*y*y;
  Bx[28]=x*x*x*x*x*y*y*y*y;
  Bx[29]=x*x*x*x*y*y*y*y*y;
  Bx[30]=x*x*x*y*y*y*y*y*y;
  Bx[31]=x*x*y*y*y*y*y*y*y;
  Bx[32]=x*y*y*y*y*y*y*y*y;
  Bx[33]=y*y*y*y*y*y*y*y*y;
}

//#define MNUM2 7
/*-----------------------------------------------------*/
//void InvM(int Order, float M[][MNUM2], float Mout[][MNUM2])
void InvM(int Order, double M[][MNUM2], double Mout[][MNUM2])
/*-----------------------------------------------------*/
{
     	int i,j,k;
	//float Mdi,Mtemp[MNUM2][MNUM2], I[MNUM2][MNUM2];
	double Mdi,Mtemp[MNUM2][MNUM2], I[MNUM2][MNUM2];
	//	float Mdi,Mtemp[MNUM2][MNUM2],Mtemp2[MNUM2][MNUM2],I[MNUM2][MNUM2],Itemp[MNUM2][MNUM2]={0};
	//char buf[BUFSIZ];
                   
	for(i=0;i<Order;i++)
	  for(j=0;j<Order;j++){
	    if(i==j){
	      I[i][j]=1;
	    }else{
	      I[i][j]=0;
	    }
	  }         
	for(k=0;k<Order;k++){                
	  Mdi=M[k][k];         
	  for(i=0;i<Order;i++){      
	    M[i][k]=M[i][k]/Mdi;
	    I[i][k]=I[i][k]/Mdi;
	  }                        
	
	  for(i=0;i<Order;i++) 
	    for(j=0;j<Order;j++) 
	      Mtemp[i][j]=M[i][j];
	  for(j=0;j<Order;j++)  
	    if(j==k){
	    }else{   
	      for(i=0;i<Order;i++){
		M[i][j]-=Mtemp[k][j]*M[i][k];
		I[i][j]-=Mtemp[k][j]*I[i][k];
	      }	
	    }
	}      
	for(i=0;i<Order;i++) 
	  for(j=0;j<Order;j++) 
	    Mout[i][j]=I[i][j];
} 

/*-----------------------------------------------------*/
//int fpdEst(int A, float EL, float x[], float ex[])
int fpdEst(int A, double EL, double x[], double ex[], double (*Apdx)[ANUM][2], double (*Adpx)[ANUM][2])
/*-----------------------------------------------------*/
{
	int i,j,k;
	double ELratio;
	//float Ax[10][ANUM][2];
	double Bx[ANUM],ELex[10][2];
	double Cx[7],Dx[7][7],InvDx[7][7],Ex[7];
	double Cy[7],Dy[7][7],InvDy[7][7],Ey[7];
	if(EL>90||EL<30){
		printf("----- Irregular Elevation (EL=%f) -----\n",EL);
		//goto AA;
		return -1;
	}

	ELratio=0.1*(EL-10*(int)(0.1*EL+INFMIN));
	
        fBx(x,Bx);
	                 
	for(k=3;k<  10;k++){
		ELex[k][0]=x[0];
		ELex[k][1]=x[1];
	}

	if(A==0){

	  for(k=3;k<  10;k++)
	    for(i=0;i<ANUM;i++)
	      for(j=0;j< 2;j++)
		ELex[k][j]+=Apdx[k][i][j]*Bx[i];  /* Apdx is currently a global variable - pointer to the array[10][34][2] */
	}	
	else if(A==1){

	  for(k=3;k<  10;k++)
	    for(i=0;i<ANUM;i++)
	      for(j=0;j< 2;j++)
		ELex[k][j]+=Adpx[k][i][j]*Bx[i];  /* Apdx is currently a global variable - pointer to the array[10][34][2] */

	}
	else{
	  printf("----- A must be 0 or 1 (A=%d) -----\n",A);
	  return -1;
	}
	

#if DEBUG
printf("x(90->30):%f	%f	%f	%f	%f	%f	%f\n",ELex[9][0],ELex[8][0],ELex[7][0],ELex[6][0],ELex[5][0],ELex[4][0],ELex[3][0]);
printf("y(90->30):%f	%f	%f	%f	%f	%f	%f\n",ELex[9][1],ELex[8][1],ELex[7][1],ELex[6][1],ELex[5][1],ELex[4][1],ELex[3][1]);
#endif
	
	for(i=0;i<7;i++){
		Cx[i]=ELex[9-i][0];        
		Cy[i]=ELex[9-i][1];
		for(j=0;j<7;j++){
			Dx[i][j]=pow(i*10,j);
			Dy[i][j]=pow(i*10,j);
		}
	}
	                                                                                  
	InvM(7,Dx,InvDx);   
	InvM(7,Dy,InvDy);                                       
	
	for(i=0;i<7;i++)
	  Ex[i]=Ey[i]=0;
	for(i=0;i<7;i++)
	  for(j=0;j<7;j++){
	    Ex[i]+=InvDx[i][j]*Cx[j];
	    Ey[i]+=InvDy[i][j]*Cy[j];
	  }
	
        ex[0]=ex[1]=0.0; 
	for(i=0;i<7;i++){
		ex[0]+=Ex[i]*pow(90.-EL,i);
		ex[1]+=Ey[i]*pow(90.-EL,i);
	}
	
	return 0;
}

/*-----------------------------------------------------*/
int setDpArray(double (*Adpx)[ANUM][2])
/*-----------------------------------------------------*/
{
  int i;
  double *p;

  /* coefficients for ELdpAx */
  p=ELdpAx2nd30;
  for(i=0; i<ANUM; i++) {
    Adpx[3][i][0]=*p++;
    Adpx[3][i][1]=*p++;
 }              
  p=ELdpAx2nd40;
  for(i=0; i<ANUM; i++) {
    Adpx[4][i][0]=*p++;
    Adpx[4][i][1]=*p++;
  }              
  p=ELdpAx2nd50;
  for(i=0; i<ANUM; i++) {
    Adpx[5][i][0]=*p++;
    Adpx[5][i][1]=*p++;
  }              
  p=ELdpAx2nd60;
  for(i=0; i<ANUM; i++) {
    Adpx[6][i][0]=*p++;
    Adpx[6][i][1]=*p++;
  }              
  p=ELdpAx2nd70; 
  for(i=0; i<ANUM; i++) {
    Adpx[7][i][0]=*p++;
    Adpx[7][i][1]=*p++;
  }              
  p=ELdpAx2nd80;
  for(i=0; i<ANUM; i++) {
    Adpx[8][i][0]=*p++;
    Adpx[8][i][1]=*p++;
  }              
  p=ELdpAx2nd90;
  for(i=0; i<ANUM; i++) {
    Adpx[9][i][0]=*p++;
    Adpx[9][i][1]=*p++;
  }              
 
  return 0;
}



/*-----------------------------------------------------*/
int setPdArray(double (*Apdx)[ANUM][2])
/*-----------------------------------------------------*/
{
  /* 
     necessary memory allocation by global variables:
     Adpx[>=7][34][2] 
     Apdx[>=7][34][2] 
  */
  int i;
  double *p;

  /* coefficients for ELpdAx */
  p=ELpdAx2nd30;
  for(i=0; i<ANUM; i++) {
    Apdx[3][i][0]=*p++;
    Apdx[3][i][1]=*p++;
//    printf("Apdx30: %lg %lg\n",  Apdx[3][i][0], Apdx[3][i][1]);
  }              
  p=ELpdAx2nd40;
  for(i=0; i<ANUM; i++) {
    Apdx[4][i][0]=*p++;
    Apdx[4][i][1]=*p++;
  }              
  p=ELpdAx2nd50;
  for(i=0; i<ANUM; i++) {
    Apdx[5][i][0]=*p++;
    Apdx[5][i][1]=*p++;
  }              
  p=ELpdAx2nd60;
  for(i=0; i<ANUM; i++) {
    Apdx[6][i][0]=*p++;
    Apdx[6][i][1]=*p++;
  }              
  p=ELpdAx2nd70;
  for(i=0; i<ANUM; i++) {
    Apdx[7][i][0]=*p++;
    Apdx[7][i][1]=*p++;
  }              
  p=ELpdAx2nd80; 
  for(i=0; i<ANUM; i++) {
    Apdx[8][i][0]=*p++;
    Apdx[8][i][1]=*p++;
  }              
  p=ELpdAx2nd90;
  for(i=0; i<ANUM; i++) {
    Apdx[9][i][0]=*p++;
    Apdx[9][i][1]=*p++;
  }              
 
  return 0;
}
